import{_ as f,o as n,c as o,w as h,V as u,b as c,l as m}from"./index.0bd43ae6.js";import{V as _}from"./VAlert.dbb0530d.js";import{V as b}from"./VTable.d9109990.js";import{V as g}from"./VTextField.a62d9ad0.js";const p={name:"DataTableComponent",props:{modelValue:Object,file:String,search:String,scroll:{type:Object,default:()=>({})},has_scroll:Boolean,searchable_fields:Object,filter:Object,letter:String,sort_by:String},data:()=>({all_data:[],filter_data:[],data:[],limit:0,error:null,last_filter:{},loading:!0}),watch:{async file(){await this.loadData()},search(){this.filterData()},searchable_fields(){this.compareFilterData()},filter(){this.compareFilterData()},letter(){this.compareFilterData()},async data(){this.$emit("update:modelValue",{total_count:this.all_data.length,filter_count:this.filter_data.length,count:this.data.length,data:this.data})},async scroll(){this.scroll.scroll_bottom<=50&&this.data.length<this.filter_data.length&&this.paginateData()}},methods:{async loadData(){this.all_data=[],this.filter_data=[],this.data=[],this.loading=!0,this.all_data=await this.$database.get(this.file),this.all_data==null&&(this.error=this.$t("components.datatable.alerts.not_found")),this.sort_by&&this.all_data.sort((t,i)=>this.$string.sort(t[this.sort_by],i[this.sort_by])),this.filterData()},filterData(){this.limit=0;const t=this.$string.clean(this.search);let i=this.searchable_fields?Object.keys(this.searchable_fields).filter(e=>this.searchable_fields[e]===!0):[],a=this.filter?Object.keys(this.filter).filter(e=>this.filter[e]===!0):[];this.filter_data=this.all_data.filter(e=>{const d=i.length===0||t==""||i.some(r=>!isNaN(e[r])&&!isNaN(t)?Number(e[r])===Number(t):isNaN(e[r])?this.$string.clean(e[r]).includes(t):!1),l=a.length===0||a.some(r=>e[r]===!0||e[r]===1),s=this.letter===""||(this.letter==="#"?/^[^a-zA-Z]/.test(e.name.normalize("NFD").replace(/[\u0300-\u036f]/g,"")):e.name.normalize("NFD").replace(/[\u0300-\u036f]/g,"").startsWith(this.letter));return d&&l&&s}).slice(),this.paginateData()},paginateData(){this.limit+=10,this.data=this.filter_data.slice(0,this.limit),this.loading=!1;const t=this;setTimeout(()=>{!t.has_scroll&&t.data.length<t.filter_data.length&&t.paginateData()},100)},compareFilterData(){let t={searchable_fields:this.searchable_fields,filter:this.filter,letter:this.letter};JSON.stringify(t)!==JSON.stringify(this.last_filter)&&(this.last_filter=t,this.filterData())}},async mounted(){await this.loadData()}};function y(t,i,a,e,d,l){return n(),o(b,{"fixed-header":"",hover:"",loading:"",density:"compact",class:"__table-data"},{bottom:h(()=>[t.loading?(n(),o(u,{key:0,color:t.$theme.primary(),indeterminate:""},null,8,["color"])):c("",!0),t.error?(n(),o(_,{key:1,type:"error",text:t.error,variant:"tonal",border:"start",class:"ma-2"},null,8,["text"])):c("",!0)]),default:h(()=>[m(t.$slots,"default")]),_:3})}const v=f(p,[["render",y]]),D={name:"InputSearchComponent",props:{modelValue:String,label:String,disabled:Boolean,disabledHint:String,error:Boolean},computed:{input:{get(){return this.modelValue},set(t){this.$emit("update:modelValue",t)}}},methods:{reset(){this.input=""}}};function V(t,i,a,e,d,l){return n(),o(g,{modelValue:l.input,"onUpdate:modelValue":i[0]||(i[0]=s=>l.input=s),color:t.$theme.primary(),disabled:a.disabled,label:a.label,"prepend-inner-icon":"mdi-magnify","append-inner-icon":l.input?"mdi-close":"",density:"compact",variant:"outlined","hide-details":!a.disabled,hint:a.disabled?a.disabledHint:"","persistent-hint":a.disabled,loading:a.disabled,error:a.error,"onClick:appendInner":i[1]||(i[1]=s=>l.reset())},null,8,["modelValue","color","disabled","label","append-inner-icon","hide-details","hint","persistent-hint","loading","error"])}const C=f(D,[["render",V]]);export{v as L,C as a};
